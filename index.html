<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Atticus - Voice-Controlled UI Library</title>
        <meta
            name="description"
            content="A framework-agnostic voice agent library for voice-controlled UI interactions, powered by OpenAI's Realtime API. Control your web apps with voice commands."
        />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://atticus.rajnandan.com/" />
        <meta
            property="og:title"
            content="Atticus - Voice-Controlled UI Library"
        />
        <meta
            property="og:description"
            content="A framework-agnostic voice agent library for voice-controlled UI interactions, powered by OpenAI's Realtime API."
        />
        <meta
            property="og:image"
            content="https://atticus.rajnandan.com/banner.png"
        />

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image" />
        <meta property="twitter:url" content="https://atticus.rajnandan.com/" />
        <meta
            property="twitter:title"
            content="Atticus - Voice-Controlled UI Library"
        />
        <meta
            property="twitter:description"
            content="A framework-agnostic voice agent library for voice-controlled UI interactions, powered by OpenAI's Realtime API."
        />
        <meta
            property="twitter:image"
            content="https://atticus.rajnandan.com/banner.png"
        />

        <!-- Favicon -->
        <link rel="icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/logo.png" />
        <link rel="apple-touch-icon" href="/logo.png" />

        <!-- Bulma CSS -->
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css"
        />
        <!-- Font Awesome for icons -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        />
        <link rel="stylesheet" href="style.css" />
        <!-- jQuery -->
        <script
            src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous"
        ></script>
    </head>
    <body>
        <!-- Navigation -->
        <nav
            class="navbar"
            style="background-color: #222"
            role="navigation"
            aria-label="main navigation"
        >
            <div class="container">
                <div class="navbar-brand py-4">
                    <a
                        class="navbar-item"
                        href="/"
                        style="background-color: #a8df8e; border-radius: 15px"
                    >
                        <img
                            src="logo.png"
                            alt="Atticus Logo"
                            style="height: 28px; max-height: 28px; color: #111"
                        />
                        <span
                            class="ml-2 has-text-weight-bold pr-2"
                            style="color: #111"
                            >Atticus</span
                        >
                    </a>
                    <span class="mt-3 ml-2"> Voice Controlled UI Library </span>
                </div>
                <div class="navbar-end">
                    <div class="navbar-item">
                        <div class="buttons">
                            <a
                                class="button is-light is-small"
                                href="https://github.com/rajnandan1/atticus"
                                target="_blank"
                            >
                                <span class="icon"
                                    ><i class="fab fa-github"></i
                                ></span>
                                <span>GitHub</span>
                            </a>
                            <a
                                class="button is-warning is-small"
                                href="https://github.com/rajnandan1/atticus/issues/new"
                                target="_blank"
                            >
                                <span class="icon"
                                    ><i class="fas fa-bug"></i
                                ></span>
                                <span>Report Issue</span>
                            </a>
                            <a
                                class="button is-info is-small"
                                href="https://www.buymeacoffee.com/rajnandan1"
                                target="_blank"
                            >
                                <span class="icon"
                                    ><i class="fas fa-coffee"></i
                                ></span>
                                <span>Donate</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <section class="section">
            <div class="container">
                <div class="columns">
                    <!-- Left Column: Connection & Form -->
                    <div class="column is-7">
                        <!-- Connection Card -->
                        <div class="card mb-5">
                            <header class="card-header">
                                <p class="card-header-title">
                                    <i class="fas fa-plug mr-2"></i> Connection
                                </p>
                            </header>
                            <div class="card-content">
                                <div class="field">
                                    <label class="label"
                                        >Client Secret (Ephemeral Key)</label
                                    >
                                    <div class="control has-icons-left">
                                        <input
                                            class="input"
                                            type="password"
                                            id="clientSecret"
                                            placeholder="ek_..."
                                        />
                                        <span class="icon is-left">
                                            <i class="fas fa-key"></i>
                                        </span>
                                    </div>
                                    <p class="help">
                                        Get this from OpenAI API - see curl
                                        example below
                                    </p>
                                </div>

                                <div class="columns">
                                    <div class="column">
                                        <div class="field">
                                            <label class="label"
                                                >Language</label
                                            >
                                            <div class="control">
                                                <div
                                                    class="select is-fullwidth"
                                                >
                                                    <select id="language">
                                                        <option value="en">
                                                            English
                                                        </option>
                                                        <option value="hi">
                                                            Hindi
                                                        </option>
                                                        <option value="es">
                                                            Spanish
                                                        </option>
                                                        <option value="fr">
                                                            French
                                                        </option>
                                                        <option value="de">
                                                            German
                                                        </option>
                                                        <option value="it">
                                                            Italian
                                                        </option>
                                                        <option value="pt">
                                                            Portuguese
                                                        </option>
                                                        <option value="ru">
                                                            Russian
                                                        </option>
                                                        <option value="ja">
                                                            Japanese
                                                        </option>
                                                        <option value="ko">
                                                            Korean
                                                        </option>
                                                        <option value="zh">
                                                            Chinese
                                                        </option>
                                                        <option value="ar">
                                                            Arabic
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="column">
                                        <div class="field">
                                            <label class="label">Voice</label>
                                            <div class="control">
                                                <div
                                                    class="select is-fullwidth"
                                                >
                                                    <select id="voice">
                                                        <option value="alloy">
                                                            Alloy (Neutral)
                                                        </option>
                                                        <option value="ash">
                                                            Ash (Soft)
                                                        </option>
                                                        <option value="ballad">
                                                            Ballad (Warm)
                                                        </option>
                                                        <option value="coral">
                                                            Coral (Clear)
                                                        </option>
                                                        <option value="echo">
                                                            Echo (Smooth)
                                                        </option>
                                                        <option value="sage">
                                                            Sage (Calm)
                                                        </option>
                                                        <option
                                                            value="shimmer"
                                                            selected
                                                        >
                                                            Shimmer (Bright)
                                                        </option>
                                                        <option value="verse">
                                                            Verse (Articulate)
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="field">
                                    <div class="control">
                                        <button
                                            id="connectBtn"
                                            class="button is-primary is-medium is-fullwidth"
                                        >
                                            <span class="icon">
                                                <i class="fas fa-play"></i>
                                            </span>
                                            <span>Connect</span>
                                        </button>
                                    </div>
                                </div>

                                <div class="level mt-4">
                                    <div class="level-left">
                                        <div class="level-item">
                                            <span
                                                class="tag is-medium"
                                                id="statusTag"
                                            >
                                                <span
                                                    class="status-dot idle"
                                                    id="statusDot"
                                                ></span>
                                                <span id="statusText"
                                                    >Idle</span
                                                >
                                            </span>
                                        </div>
                                        <div class="level-item">
                                            <span
                                                id="speakingState"
                                                class="has-text-grey"
                                            ></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Form Card -->
                        <div class="card" id="formContainer">
                            <header class="card-header">
                                <p class="card-header-title">
                                    <i class="fas fa-edit mr-2"></i> Contact
                                    Form
                                </p>
                            </header>
                            <div class="card-content">
                                <p class="mb-4 has-text-grey">
                                    Try saying: "Fill the first name with John"
                                    or "Set email to john@example.com"
                                </p>

                                <div class="columns">
                                    <div class="column">
                                        <div class="field">
                                            <label class="label"
                                                >First Name</label
                                            >
                                            <div class="control">
                                                <input
                                                    class="input"
                                                    type="text"
                                                    id="firstName"
                                                    placeholder="John"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="column">
                                        <div class="field">
                                            <label class="label"
                                                >Last Name</label
                                            >
                                            <div class="control">
                                                <input
                                                    class="input"
                                                    type="text"
                                                    id="lastName"
                                                    placeholder="Doe"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="columns">
                                    <div class="column">
                                        <div class="field">
                                            <label class="label">Email</label>
                                            <div class="control has-icons-left">
                                                <input
                                                    class="input"
                                                    type="email"
                                                    id="email"
                                                    placeholder="john@example.com"
                                                />
                                                <span class="icon is-left">
                                                    <i
                                                        class="fas fa-envelope"
                                                    ></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="column">
                                        <div class="field">
                                            <label class="label">Phone</label>
                                            <div class="control has-icons-left">
                                                <input
                                                    class="input"
                                                    type="tel"
                                                    id="phone"
                                                    placeholder="+1 234 567 8900"
                                                />
                                                <span class="icon is-left">
                                                    <i class="fas fa-phone"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="columns">
                                    <div class="column">
                                        <div class="field">
                                            <label class="label"
                                                >Department</label
                                            >
                                            <div class="control">
                                                <div
                                                    class="select is-fullwidth"
                                                >
                                                    <select id="department">
                                                        <option value="">
                                                            Select department...
                                                        </option>
                                                        <option value="sales">
                                                            Sales
                                                        </option>
                                                        <option value="support">
                                                            Support
                                                        </option>
                                                        <option
                                                            value="engineering"
                                                        >
                                                            Engineering
                                                        </option>
                                                        <option
                                                            value="marketing"
                                                        >
                                                            Marketing
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="column">
                                        <div class="field">
                                            <label class="label"
                                                >Priority</label
                                            >
                                            <div class="control">
                                                <div
                                                    class="select is-fullwidth"
                                                >
                                                    <select id="priority">
                                                        <option value="">
                                                            Select priority...
                                                        </option>
                                                        <option value="low">
                                                            Low
                                                        </option>
                                                        <option value="medium">
                                                            Medium
                                                        </option>
                                                        <option value="high">
                                                            High
                                                        </option>
                                                        <option value="urgent">
                                                            Urgent
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="field">
                                    <label class="label">Message</label>
                                    <div class="control">
                                        <textarea
                                            class="textarea"
                                            id="message"
                                            placeholder="Enter your message..."
                                        ></textarea>
                                    </div>
                                </div>

                                <div class="field is-grouped">
                                    <div class="control">
                                        <button
                                            id="submitBtn"
                                            class="button is-primary"
                                        >
                                            <span class="icon"
                                                ><i
                                                    class="fas fa-paper-plane"
                                                ></i
                                            ></span>
                                            <span>Submit</span>
                                        </button>
                                    </div>
                                    <div class="control">
                                        <button
                                            id="clearBtn"
                                            class="button is-light"
                                        >
                                            <span class="icon"
                                                ><i class="fas fa-eraser"></i
                                            ></span>
                                            <span>Clear</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column: Conversation & Actions -->
                    <div class="column is-5">
                        <!-- Conversation Card -->
                        <div class="card mb-5">
                            <header class="card-header">
                                <p class="card-header-title">
                                    <i class="fas fa-comments mr-2"></i>
                                    Conversation
                                </p>
                            </header>
                            <div class="card-content">
                                <div
                                    id="speakingIndicator"
                                    class="notification is-info is-light mb-3"
                                    style="display: none"
                                >
                                    <div class="is-flex is-align-items-center">
                                        <div class="speaking-bars mr-3">
                                            <div class="speaking-bar"></div>
                                            <div class="speaking-bar"></div>
                                            <div class="speaking-bar"></div>
                                            <div class="speaking-bar"></div>
                                        </div>
                                        <span id="speakingText"
                                            >AI is speaking...</span
                                        >
                                    </div>
                                </div>
                                <div class="conversation-box" id="conversation">
                                    <p class="has-text-grey has-text-centered">
                                        <i
                                            class="fas fa-comment-slash mr-2"
                                        ></i>
                                        No messages yet. Connect and start
                                        talking!
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Action Log Card -->
                        <div class="card mb-5">
                            <header class="card-header">
                                <p class="card-header-title">
                                    <i class="fas fa-bolt mr-2"></i> Action Log
                                </p>
                            </header>
                            <div class="card-content">
                                <div class="action-log" id="actionLog">
                                    <span class="has-text-grey"
                                        >UI actions will appear here...</span
                                    >
                                </div>
                            </div>
                        </div>

                        <!-- How to Get Client Secret -->
                        <div class="card">
                            <header class="card-header">
                                <p class="card-header-title">
                                    <i class="fas fa-terminal mr-2"></i> Get
                                    Client Secret
                                </p>
                            </header>
                            <div class="card-content">
                                <p class="mb-3">
                                    Run this curl command to get an ephemeral
                                    client secret:
                                </p>
                                <pre class="curl-example">
curl -X POST "https://api.openai.com/v1/realtime/sessions" \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
  "session": {
    "type": "realtime",
    "model": "gpt-4o-realtime-preview"
  },
  "expires_after": {
      "anchor": "created_at",
      "seconds": 7200
    }
}'</pre
                                >
                                <p class="mt-3 has-text-grey is-size-7">
                                    Copy the
                                    <code>client_secret.value</code> from the
                                    response and paste above.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Atticus via CDN -->
        <script src="/dist/index.global.js"></script>
        <!-- For local development, use: -->
        <!-- <script src="../dist/index.global.js"></script> -->

        <script>
            // Atticus is available globally after loading the script
            console.log("Atticus loaded:", Atticus);

            // DOM Elements
            const $clientSecretInput = $("#clientSecret");
            const $languageSelect = $("#language");
            const $voiceSelect = $("#voice");
            const $connectBtn = $("#connectBtn");
            const $statusDot = $("#statusDot");
            const $statusText = $("#statusText");
            const $speakingState = $("#speakingState");
            const $speakingIndicator = $("#speakingIndicator");
            const $speakingTextEl = $("#speakingText");
            const $conversation = $("#conversation");
            const $actionLog = $("#actionLog");
            const formContainer = document.getElementById("formContainer");
            const $submitBtn = $("#submitBtn");
            const $clearBtn = $("#clearBtn");

            let agent = null;

            // Update status indicator
            function updateStatus(status) {
                $statusDot.attr("class", "status-dot " + status);
                const statusLabels = {
                    idle: "Idle",
                    connecting: "Connecting...",
                    connected: "Connected",
                    error: "Error",
                };
                $statusText.text(statusLabels[status] || status);

                // Update button
                if (status === "connected") {
                    $connectBtn
                        .html(
                            '<span class="icon"><i class="fas fa-stop"></i></span><span>Disconnect</span>'
                        )
                        .attr(
                            "class",
                            "button is-danger is-medium is-fullwidth"
                        )
                        .prop("disabled", false);
                } else if (status === "connecting") {
                    $connectBtn
                        .html(
                            '<span class="icon"><i class="fas fa-spinner fa-spin"></i></span><span>Connecting...</span>'
                        )
                        .prop("disabled", true);
                } else {
                    $connectBtn
                        .html(
                            '<span class="icon"><i class="fas fa-play"></i></span><span>Connect</span>'
                        )
                        .attr(
                            "class",
                            "button is-primary is-medium is-fullwidth"
                        )
                        .prop("disabled", false);
                }
            }

            // Update conversation state
            function updateConversationState(state) {
                const stateLabels = {
                    idle: "",
                    ai_speaking: "üîä AI Speaking",
                    user_turn: "üé§ Your turn",
                    user_speaking: "üéôÔ∏è Listening...",
                };
                $speakingState.text(stateLabels[state] || "");

                if (state === "ai_speaking") {
                    $speakingIndicator.show();
                    $speakingTextEl.text("AI is speaking...");
                } else if (state === "user_speaking") {
                    $speakingIndicator.show();
                    $speakingTextEl.text("Listening...");
                } else {
                    $speakingIndicator.hide();
                }
            }

            // Add message to conversation
            function addMessage(message) {
                // Clear placeholder
                const $placeholder = $conversation.find("p.has-text-grey");
                if ($placeholder.length) $conversation.empty();

                const $div = $("<div>").addClass("message " + message.role);

                const $role = $("<div>")
                    .addClass("role")
                    .text(message.role === "user" ? "You" : "Assistant");

                const $content = $("<div>").text(
                    message.content.type === "text"
                        ? message.content.text
                        : message.content.transcript || "(audio)"
                );

                $div.append($role).append($content);
                $conversation.append($div);
                $conversation.scrollTop($conversation[0].scrollHeight);
            }

            // Log action
            function logAction(action, result) {
                // Clear placeholder
                const $placeholder = $actionLog.find("span.has-text-grey");
                if ($placeholder.length) $actionLog.empty();

                const $entry = $("<div>").addClass("action-entry");
                $entry.html(`
                    <div class="action-text">üì¢ ${action.outputText}</div>
                    ${
                        action.outputCode
                            ? `<div class="action-code">‚ö° ${action.outputCode}</div>`
                            : ""
                    }
                    ${
                        result
                            ? `<div class="${
                                  result.success
                                      ? "action-result"
                                      : "action-error"
                              }">
                        ${result.success ? "‚úì Success" : "‚úó " + result.error}
                    </div>`
                            : ""
                    }
                `);
                $actionLog.append($entry);
                $actionLog.scrollTop($actionLog[0].scrollHeight);
            }

            // Connect/disconnect
            async function toggleConnection() {
                if (agent && agent.isConnected) {
                    agent.disconnect();
                    agent = null;
                    return;
                }

                const clientSecret = $clientSecretInput.val().trim();
                if (!clientSecret) {
                    alert(
                        "Please enter a client secret. See the curl command below to get one."
                    );
                    return;
                }

                try {
                    // Create Atticus instance using global Atticus.Atticus
                    agent = new Atticus.Atticus({
                        clientSecret,
                        language: $languageSelect.val(),
                        voice: $voiceSelect.val(),
                        agent: {
                            name: "Form Assistant",
                            instructions: `You are a helpful assistant that helps users fill out a contact form.

The form has these fields:
- First Name (id: firstName)
- Last Name (id: lastName)
- Email (id: email)
- Phone (id: phone)
- Department (id: department) - options: sales, support, engineering, marketing
- Priority (id: priority) - options: low, medium, high, urgent
- Message (id: message) - textarea

When the user asks to fill a field, use the execute_ui_action tool to set the value.
Be friendly and confirm what you've done.`,
                        },
                        debug: true,
                        ui: {
                            enabled: true,
                            rootElement: formContainer,
                        },
                    });

                    // Event listeners
                    agent.on("statusChange", updateStatus);
                    agent.on(
                        "conversationStateChange",
                        updateConversationState
                    );
                    agent.on("message", addMessage);
                    agent.on("error", (err) => {
                        console.error("Error:", err);
                        alert("Error: " + err);
                    });
                    agent.on("action", (action) => {
                        console.log("Action executed:", action);
                        logAction(action, { success: true });
                    });

                    await agent.connect();
                    console.log("Connected successfully!");
                } catch (err) {
                    console.error("Connection failed:", err);
                    alert("Connection failed: " + err.message);
                }
            }

            // Event listeners
            $connectBtn.on("click", toggleConnection);

            $submitBtn.on("click", () => {
                const formData = {
                    firstName: $("#firstName").val(),
                    lastName: $("#lastName").val(),
                    email: $("#email").val(),
                    phone: $("#phone").val(),
                    department: $("#department").val(),
                    priority: $("#priority").val(),
                    message: $("#message").val(),
                };
                console.log("Form submitted:", formData);
                alert("Form submitted! Check console for data.");
            });

            $clearBtn.on("click", () => {
                [
                    "firstName",
                    "lastName",
                    "email",
                    "phone",
                    "department",
                    "priority",
                    "message",
                ].forEach((id) => {
                    $("#" + id).val("");
                });
            });

            // Allow Enter key to connect
            $clientSecretInput.on("keypress", (e) => {
                if (e.key === "Enter") toggleConnection();
            });
        </script>
    </body>
</html>
